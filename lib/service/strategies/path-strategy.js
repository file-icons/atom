"use strict";const IconTables=require("../../icons/icon-tables.js"),Strategy=require("../strategy.js");class PathStrategy extends Strategy{constructor(){super({priority:1,matchesFiles:true,matchesDirs:true,noSetting:true,ignoreVirtual:false})}registerResource(resource){if(super.registerResource(resource)){const disposables=this.resourceEvents.get(resource);return disposables.add(resource.onDidMove(()=>this.check(resource,false))),this.resourceEvents.set(resource,disposables),true}return false}matchIcon(resource){let icon=null;if(resource.isDirectory)return icon=IconTables.matchPath(resource.path,true)||IconTables.matchName(resource.name,true)||null;else{let{name}=resource,path=resource.realPath||resource.path,isFiltered=false;const filtered=this.filter(name)||name;return filtered!==name&&(isFiltered=true,name=filtered,path=this.filter(path)),icon=IconTables.matchPath(path)||IconTables.matchName(name)||null,isFiltered&&(null===icon||1>icon.priority)&&(icon=IconTables.matchName(resource.name)),icon||null}}filter(path){return path.replace(/~(?:orig|previous)$/,"").replace(/^([^.]*\.[^.]+)\.(?:inc?|dist|tm?pl|te?mp|ti?dy)$/i,"$1")}}module.exports=new PathStrategy;